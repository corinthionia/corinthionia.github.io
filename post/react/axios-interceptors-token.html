<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/a15f2fce4b98b461-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/ff840cfebfb63b0c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/d63a22f1046c7c17.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/cb6c7fd55e08d193.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/c3d89801d8524888.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b1a9bc1363601fa9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-90889ba8e7036f49.js"/><script src="/_next/static/chunks/1acbb86d-efb2e74c2b74ce20.js" async=""></script><script src="/_next/static/chunks/886-bb14d9967806ac84.js" async=""></script><script src="/_next/static/chunks/main-app-eadae1023591cf60.js" async=""></script><script src="/_next/static/chunks/943-00bda20aa4b030d5.js" async=""></script><script src="/_next/static/chunks/378-0044a6d389c6dd71.js" async=""></script><script src="/_next/static/chunks/app/layout-c1512531c277b35c.js" async=""></script><script src="/_next/static/chunks/app/post/%5B...slug%5D/page-32b90493c9917848.js" async=""></script><title>axios request interceptors 로 access token 재발급하기 | Corinthionia</title><meta name="description" content="axios request interceptors 로 access token 재발급하기"/><meta name="application-name" content="Corinthionia"/><link rel="canonical" href="https://corinthionia.github.io"/><link rel="alternate" hrefLang="en-US" href="https://corinthionia.github.io/en-US"/><link rel="alternate" hrefLang="ko-KR" href="https://corinthionia.github.io/ko-KR"/><meta name="google-site-verification" content="yUSWYuB2Vp_rkwga3zPaQBERVNUHmls939PmQ7PY0VE"/><meta property="og:title" content="axios request interceptors 로 access token 재발급하기"/><meta property="og:description" content="axios request interceptors 로 access token 재발급하기"/><meta property="og:url" content="https://corinthionia.github.io/post/react/axios-interceptors-token"/><meta property="og:site_name" content="Corinthionia"/><meta property="og:locale" content="ko_KR"/><meta property="og:image" content="https://corinthionia.github.io/thumbnail/post/axios-interceptor-token.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-01-23T00:00:00.000Z"/><meta property="article:modified_time" content="2022-01-23T00:00:00.000Z"/><meta property="article:author" content="Corinthionia"/><meta property="article:author" content="Joohyun Kim"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="axios request interceptors 로 access token 재발급하기"/><meta name="twitter:description" content="axios request interceptors 로 access token 재발급하기"/><meta name="twitter:image" content="https://corinthionia.github.io/thumbnail/post/axios-interceptor-token.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_f765bc"><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="Header_wrapper__seTP2"><div class="Header_itemWrapper__bpYR2"><img alt="menu" loading="lazy" width="28" height="28" decoding="async" data-nimg="1" class="Header_menu__t5XtG" style="color:transparent" src="/profile.svg"/><a href="/"><img alt="logo" loading="lazy" width="140" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/header_logo.09f5af74.svg"/></a><div class="Header_right__AJNjV"><div class="Header_menus__BxqTv"><a href="/post"><span>포스트</span></a><a href="/note"><span>노트</span></a><a href="/snippet"><span>코드조각</span></a></div><span class="Header_border__mqVUf">|</span><img alt="theme" loading="lazy" width="32" height="32" decoding="async" data-nimg="1" class="Header_theme__g2lZL" style="color:transparent;cursor:pointer" src="/_next/static/media/dark.afa46c62.svg"/></div></div></div><div class="app_layout__Cl2eA"><div class="app_grid__9m74A"><main class="app_contents__RnFvu"><article class="PostLayout_wrapper__4Zx6Q"><header class="Header_header__KPaCf"><h2 class="Header_title__yFEr0">axios request interceptors 로 access token 재발급하기</h2><div class="Header_info__GOBJ7"><a target="_blank" href="https://github.com/corinthionia"><span>@corinthionia</span></a><span>January 23, 2022</span></div></header><main class="MDX_mdx__VyFNl"><p>사실 이 부분은 금방 끝날 줄 알았는데 아니었다... ㅠ<br/>
<!-- -->삽질도 많이 하고 에러도 많이 마주쳤던 부분이라 기록하고자 글을 남긴다.</p>
<h2 id="1-refresh-token과-access-token"><a aria-hidden="true" tabindex="-1" href="#1-refresh-token과-access-token"><span class="icon icon-link"></span></a>1. refresh token과 access token</h2>
<p>간단하게 말하자면 access token은 사용자가 요청을 보낼 때 사용하는 토큰인데, 보안 문제로 유효 기간이 짧다.<br/>
<!-- -->refresh token은 access token보다 유효 기간이 길어서, 만약 access token이 만료되었다면 refresh token을 이용해 access token을 재발급받을 수 있다.</p>
<hr/>
<h2 id="2-구현-방식에-대한-고민들"><a aria-hidden="true" tabindex="-1" href="#2-구현-방식에-대한-고민들"><span class="icon icon-link"></span></a>2. 구현 방식에 대한 고민들</h2>
<h3 id="access-token이-만료되면-재발급-요청을-어떻게-해야-하는가"><a aria-hidden="true" tabindex="-1" href="#access-token이-만료되면-재발급-요청을-어떻게-해야-하는가"><span class="icon icon-link"></span></a>access token이 만료되면 재발급 요청을 어떻게 해야 하는가?</h3>
<ol>
<li>
<p>사용자가 만료된 access token을 가지고 요청을 보내면 그때 토큰을 재발급하는 방식<br/>
<!-- -->→ 해당 요청이 수행되지 않아 다시 요청을 보내야 하는 UX적인 단점 존재</p>
</li>
<li>
<p>토큰 만료 시점을 미리 계산하고, 만료 시점에 근접했을 때 토큰을 재발급받는 방식<br/>
<!-- -->→ 만료 시점에 근접했을 때 재발급 요청을 어떻게 해야 할지 감이 안 잡힘...</p>
</li>
<li>
<p>요청을 보낸 후 만료 응답을 받으면 그때 재발급 요청<br/>
<!-- -->→ 이래도 401 에러는 뜨더라</p>
</li>
</ol>
<br/>
<h3 id="결과적으로-채택한-방식"><a aria-hidden="true" tabindex="-1" href="#결과적으로-채택한-방식"><span class="icon icon-link"></span></a>결과적으로 채택한 방식</h3>
<p><strong>request를 가로채서 토큰의 유효 시간을 살핀 다음, 만료까지 1분 미만으로 남았다면 토큰을 재발급받은 후 해당 요청을 보내는 방식을 생각했다.</strong></p>
<p>그런데 아무리 시도해 봐도 에러 해결이 안 되고, 아무리 찾아봐도 response를 가로채는 예시들만 나와서 일단은 <code>response interceptor (응답 인터셉터)</code>로 구현했다. (이 예시는 구글링하면 많이 나와서 생략하겠다.)</p>
<p>하지만 응답 인터셉터를 사용해도 콘솔 창에 401 에러가 뜨는 게 보기 싫었고, (실행은 잘됨) <code>request interceptor (요청 인터셉터)</code>로 구현하는 게 더 효율적이라고 판단하여 처음부터 끝까지 내가 구현해 보자고 마음 먹었다.</p>
<p>따라서 구현한 코드는 다음과 같다.</p>
<hr/>
<h2 id="구현-과정"><a aria-hidden="true" tabindex="-1" href="#구현-과정"><span class="icon icon-link"></span></a>구현 과정</h2>
<h3 id="로직-설명"><a aria-hidden="true" tabindex="-1" href="#로직-설명"><span class="icon icon-link"></span></a>로직 설명</h3>
<ol>
<li>
<p>로그인 시 refresh token과 access token을 <code>local storage</code>에 저장을 해 두었고, <code>local storage</code>에 access token이 존재한다면, 이를 헤더에 담아 요청을 보낸다.</p>
</li>
<li>
<p><code>jwt-decode</code> 라이브러리를 활용하여 access token과 refresh token의 만료 시간을 알아내고, 이를 로컬 스토리지에 저장해 두었다.</p>
</li>
<li>
<p>refresh token이 로컬 스토리지에 저장이 되어 있고 (즉, 로그인한 사용자고) access token의 만료 시점과 현재 시간의 차가 1분 미만이라면, access token 재발급을 요청한다.</p>
</li>
<li>
<p>우리는 refresh token을 <code>application/x-www-form-urlencoded</code> 타입으로 담아서 보내기 때문에 <code>URLSearchParams()</code>를 사용했다.</p>
</li>
<li>
<p>그리고 재발급받은 access token과 만료 시점(expiredAt)을 로컬 스토리지에 저장해 두었다. (expiredAt을 갱신하지 않으면 또 에러가 생긴다!) 그리고 마지막 부분에는 재발급 받은 access token을 헤더에 기본으로 붙여 두었다.</p>
</li>
</ol>
<br/>
<p><strong>이때 주의할 점!</strong> interceptor 안에 refresh token을 요청하는 코드를 작성할 때, instance를 호출하면 안 된다. 그러면 요청 → interceptor 실행 → interceptor 속 instance의 interceptor 실행 → ... 으로 무한 루프가 생겨 버린다. 그래서 나도 instance를 사용하지 않고 그냥 axios를 사용했다.</p>
<br/>
<h3 id="구현한-코드"><a aria-hidden="true" tabindex="-1" href="#구현한-코드"><span class="icon icon-link"></span></a>구현한 코드</h3>
<p><code>axios.create()</code>으로 작성한 <code>instance</code>의 <code>request interceptor</code> 코드다.</p>
<pre class="language-jsx"><code class="language-jsx"><span class="code-line">instance<span class="token punctuation">.</span><span class="token property-access">interceptors</span><span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">config</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> accessToken <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&#x27;accessToken&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  accessToken <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Authorization</span></span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>accessToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&#x27;refreshToken&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> expiredAt <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&#x27;expiredAt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// if the token expires within a minute</span>
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>refreshToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>expiredAt <span class="token operator">-</span> now <span class="token operator">&lt;</span> <span class="token number">60000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      params<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">&#x27;refresh&#x27;</span><span class="token punctuation">,</span> refreshToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> axios<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">&#x27;요청 주소&#x27;</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;application/x-www-form-urlencoded&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">&#x27;accessToken&#x27;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token property-access">access</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">&#x27;expiredAt&#x27;</span><span class="token punctuation">,</span> <span class="token function">jwtDecode</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access">access</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">exp</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      config<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">&#x27;Authorization&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span><span class="token property-access">access</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> config<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<br/>
<hr/>
<h2 id="마주쳤던-에러들"><a aria-hidden="true" tabindex="-1" href="#마주쳤던-에러들"><span class="icon icon-link"></span></a>마주쳤던 에러들</h2>
<h3 id="삽질-1-date-객체-관련"><a aria-hidden="true" tabindex="-1" href="#삽질-1-date-객체-관련"><span class="icon icon-link"></span></a>삽질 1. Date 객체 관련</h3>
<p>access token을 디코딩해서 만료 시간(exp)을 알아내려고 했다. 그런데 이 값은 초 단위이고, JavaScript Date 객체를 사용해서 얻은 값은 밀리 초 단위이다. 따라서 exp 값에 1000을 곱한 후 Date 객체에 넣으면 대충 <code>Sat Jan 08 2022 03:10:30 GMT+0900 (한국 표준시)</code> 형태로 출력될 것이라고 생각했다.</p>
<p>그래서 시험 삼아 발급 시간(iat)과 만료 시간(exp) 각각에 1000을 곱한 후 Date 객체에 넣어 봤더니, 분명 다른 숫자임에도 불구하고 같은 시간대가 출력되었다. (원래는 30분의 시차가 있어야 함)</p>
<pre class="language-jsx"><code class="language-jsx"><span class="code-line"><span class="token comment">// 에러 코드</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> decoded <span class="token operator">=</span> <span class="token function">jwtDecode</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">token</span><span class="token punctuation">.</span><span class="token property-access">access</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> exp <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">exp</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> iat <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">iat</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;발급 시간: &quot;</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">(</span>iat <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;만료 시간: &quot;</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">(</span>exp <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 출력 예시</span>
</span><span class="code-line">발급 시간<span class="token operator">:</span>  <span class="token maybe-class-name">Sat</span> <span class="token maybe-class-name">Jan</span> <span class="token number">08</span> <span class="token number">2022</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">13</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0900</span> <span class="token punctuation">(</span>한국 표준시<span class="token punctuation">)</span>
</span><span class="code-line">만료 시간<span class="token operator">:</span>  <span class="token maybe-class-name">Sat</span> <span class="token maybe-class-name">Jan</span> <span class="token number">08</span> <span class="token number">2022</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">13</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0900</span> <span class="token punctuation">(</span>한국 표준시<span class="token punctuation">)</span>
</span></code></pre>
<p>거의 세 시간 동안 붙잡고 있었는데 @김현재 님이 도와주셔서 해결할 수 있었다...<br/>
<!-- -->Date ‘객체’라서 객체 참조에 관한 문제였다고 한다 🫠</p>
<pre class="language-jsx"><code class="language-jsx"><span class="code-line"><span class="token keyword">const</span> decoded <span class="token operator">=</span> <span class="token function">jwtDecode</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token property-access">token</span><span class="token punctuation">.</span><span class="token property-access">access</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> iat <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">iat</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> exp <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">exp</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;발급 시간: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>iat <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;만료 시간: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>exp <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;현재 시간: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 출력 예시</span>
</span><span class="code-line">발급 시간<span class="token operator">:</span>  <span class="token maybe-class-name">Sat</span> <span class="token maybe-class-name">Jan</span> <span class="token number">08</span> <span class="token number">2022</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">13</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0900</span> <span class="token punctuation">(</span>한국 표준시<span class="token punctuation">)</span>
</span><span class="code-line">만료 시간<span class="token operator">:</span>  <span class="token maybe-class-name">Sat</span> <span class="token maybe-class-name">Jan</span> <span class="token number">08</span> <span class="token number">2022</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">30</span><span class="token operator">:</span><span class="token number">13</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0900</span> <span class="token punctuation">(</span>한국 표준시<span class="token punctuation">)</span>
</span><span class="code-line">현재 시간<span class="token operator">:</span>  <span class="token maybe-class-name">Sat</span> <span class="token maybe-class-name">Jan</span> <span class="token number">08</span> <span class="token number">2022</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">13</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0900</span> <span class="token punctuation">(</span>한국 표준시<span class="token punctuation">)</span>
</span></code></pre>
<p>따라서 앞에 new 연산자를 꼭 붙여 줘야 제대로 나온다!</p>
<br/>
<h3 id="삽질-2-무한-루프"><a aria-hidden="true" tabindex="-1" href="#삽질-2-무한-루프"><span class="icon icon-link"></span></a>삽질 2: 무한 루프</h3>
<p>axios interceptor를 잘못 작성해서 무한 루프에 빠져 버림...</p>
<pre class="language-jsx"><code class="language-jsx"><span class="code-line"><span class="token comment">// 에러 코드 &amp;&amp; 로직 수정 전 코드</span>
</span><span class="code-line">
</span><span class="code-line">instance<span class="token punctuation">.</span><span class="token property-access">interceptors</span><span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;refreshToken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> expiredAt <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;expiredAt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>expiredAt <span class="token operator">-</span> now <span class="token operator">&lt;</span> <span class="token number">60000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      params<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">&#x27;refresh&#x27;</span><span class="token punctuation">,</span> refreshToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> instance<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token string">&#x27;요청 주소&#x27;</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;application/x-www-form-urlencoded&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 생략</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> config<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>정확하진 않지만 <code>interceptor</code> 안에서 또 <code>instance</code>를 호출해 요청을 보내다 보니 무한 루프가 생긴 것 같다 ㅠㅠ 그래서 아래처럼 수정했더니 잘됐던 걸로 기억함 (아마도)</p>
<pre class="language-jsx"><code class="language-jsx"><span class="code-line"><span class="token comment">// 에러 코드 &amp;&amp; 로직 수정 전 코드</span>
</span><span class="code-line">
</span><span class="code-line">instance<span class="token punctuation">.</span><span class="token property-access">interceptors</span><span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;refreshToken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> expiredAt <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;expiredAt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>expiredAt <span class="token operator">-</span> now <span class="token operator">&lt;</span> <span class="token number">60000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      params<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">&#x27;refresh&#x27;</span><span class="token punctuation">,</span> refreshToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> axios<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token string">&#x27;요청 주소&#x27;</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;application/x-www-form-urlencoded&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 생략</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> config<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="후기"><a aria-hidden="true" tabindex="-1" href="#후기"><span class="icon icon-link"></span></a>후기</h2>
<p>하나 고치면 다른 데서 에러 생기고 🫠 계속해서 오류를 뱉어서 화가 나긴 했지만 그래도 수정하는 재미가 있었다! 이 과정과는 별개로 token과 관련된 모든 정보들을 로컬 스토리지에 저장하는 게 맞나 하는 생각이 든다 🤔 보안상의 이슈가 있을 것 같은데 더 좋은 방법을 찾아보고 리팩토링해 봐야겠다!</p>
<hr/>
<h2 id="참고-자료"><a aria-hidden="true" tabindex="-1" href="#참고-자료"><span class="icon icon-link"></span></a>참고 자료</h2>
<p><a href="https://yamoo9.github.io/axios/guide/interceptors.html">Axios 러닝 가이드 - interceptor</a></p></main><div class="Border_border__6p8Eq"></div><section class="NeighborPost_section__W5SYa"><a href="/post/etc/move-utterances"><div class="NeighborPost_wrapper__Ul1n3"><span class="NeighborPost_top__Kp4Hx">← 이전 글</span><span class="NeighborPost_bottom__pe5NX">Utterances 댓글을 다른 포스트로 옮기기</span></div></a><a href="/post/record/mailedit-short"><div class="NeighborPost_wrapper__Ul1n3"><span class="NeighborPost_top__Kp4Hx">다음 글 →</span><span class="NeighborPost_bottom__pe5NX">MadiledIt! 개발 회고 (Short)</span></div></a></section><section></section></article><div class="TOC_wrapper__ENCeM"></div></main></div></div><footer class="Footer_wrapper__r9Ps3">© Joohyun Kim (김주현) Corinthionia</footer><script src="/_next/static/chunks/webpack-90889ba8e7036f49.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/a15f2fce4b98b461-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/ff840cfebfb63b0c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/d63a22f1046c7c17.css\",\"style\"]\n4:HL[\"/_next/static/css/cb6c7fd55e08d193.css\",\"style\"]\n5:HL[\"/_next/static/css/c3d89801d8524888.css\",\"style\"]\n6:HL[\"/_next/static/css/b1a9bc1363601fa9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"7:I[1630,[],\"\"]\na:I[4311,[],\"\"]\nc:I[7357,[],\"\"]\nd:I[1080,[\"943\",\"static/chunks/943-00bda20aa4b030d5.js\",\"378\",\"static/chunks/378-0044a6d389c6dd71.js\",\"185\",\"static/chunks/app/layout-c1512531c277b35c.js\"],\"ThemeProvider\"]\ne:I[2691,[\"943\",\"static/chunks/943-00bda20aa4b030d5.js\",\"378\",\"static/chunks/378-0044a6d389c6dd71.js\",\"185\",\"static/chunks/app/layout-c1512531c277b35c.js\"],\"default\"]\n10:I[1048,[],\"\"]\nb:[\"slug\",\"react/axios-interceptors-token\",\"c\"]\n11:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d63a22f1046c7c17.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/cb6c7fd55e08d193.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"buildId\":\"u4IiwJrcuh1NSmme3PcDL\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/react/axios-interceptors-token\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"react/axios-interceptors-token\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"react\\\",\\\"axios-interceptors-token\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"react/axios-interceptors-token\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L8\",\"$L9\"],null],null]},[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$b\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c3d89801d8524888.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b1a9bc1363601fa9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[null,[\"$\",\"body\",null,{\"className\":\"__className_f765bc\",\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{}],[\"$\",\"div\",null,{\"className\":\"app_layout__Cl2eA\",\"children\":[\"$\",\"div\",null,{\"className\":\"app_grid__9m74A\",\"children\":[\"$\",\"main\",null,{\"className\":\"app_contents__RnFvu\",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]}]}],[\"$\",\"footer\",null,{\"className\":\"Footer_wrapper__r9Ps3\",\"children\":\"© Joohyun Kim (김주현) Corinthionia\"}]]}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Lf\"],\"globalErrorComponent\":\"$10\",\"missingSlots\":\"$W11\"}]]\n"])</script><script>self.__next_f.push([1,"12:I[1943,[\"943\",\"static/chunks/943-00bda20aa4b030d5.js\",\"392\",\"static/chunks/app/post/%5B...slug%5D/page-32b90493c9917848.js\"],\"\"]\n14:I[3174,[\"943\",\"static/chunks/943-00bda20aa4b030d5.js\",\"392\",\"static/chunks/app/post/%5B...slug%5D/page-32b90493c9917848.js\"],\"default\"]\n15:I[1612,[\"943\",\"static/chunks/943-00bda20aa4b030d5.js\",\"392\",\"static/chunks/app/post/%5B...slug%5D/page-32b90493c9917848.js\"],\"default\"]\n9:[[\"$\",\"article\",null,{\"className\":\"PostLayout_wrapper__4Zx6Q\",\"children\":[[\"$\",\"header\",null,{\"className\":\"Header_header__KPaCf\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"Header_title__yFEr0\",\"children\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"div\",null,{\"className\":\"Header_info__GOBJ7\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"https://github.com/corinthionia\",\"target\":\"_blank\",\"children\":[\"$\",\"span\",null,{\"children\":\"@corinthionia\"}]}],[\"$\",\"span\",null,{\"children\":\"January 23, 2022\"}]]}]]}],[\"$\",\"main\",null,{\"className\":\"MDX_mdx__VyFNl\",\"children\":\"$L13\"}],[\"$\",\"div\",null,{\"className\":\"Border_border__6p8Eq\"}],[\"$\",\"section\",null,{\"className\":\"NeighborPost_section__W5SYa\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/post/etc/move-utterances\",\"children\":[\"$\",\"div\",null,{\"className\":\"NeighborPost_wrapper__Ul1n3\",\"children\":[[\"$\",\"span\",null,{\"className\":\"NeighborPost_top__Kp4Hx\",\"children\":\"← 이전 글\"}],[\"$\",\"span\",null,{\"className\":\"NeighborPost_bottom__pe5NX\",\"children\":\"Utterances 댓글을 다른 포스트로 옮기기\"}]]}]}],[\"$\",\"$L12\",null,{\"href\":\"/post/record/mailedit-short\",\"children\":[\"$\",\"div\",null,{\"className\":\"NeighborPost_wrapper__Ul1n3\",\"children\":[[\"$\",\"span\",null,{\"className\":\"NeighborPost_top__Kp4Hx\",\"children\":\"다음 글 →\"}],[\"$\",\"span\",null,{\"className\":\"NeighborPost_bottom__pe5NX\",\"children\":\"MadiledIt! 개발 회고 (Short)\"}]]}]}]]}],[\"$\",\"$L14\",null,{}]]}],[\"$\",\"$L15\",null,{}]]\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"axios request interceptors 로 access token 재발급하기 | Corinthionia\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"meta\",\"4\",{\"name\":\"application-name\",\"content\":\"Corinthionia\"}],[\"$\",\"link\",\"5\",{\"rel\":\"canonical\",\"href\":\"https://corinthionia.github.io\"}],[\"$\",\"link\",\"6\",{\"rel\":\"alternate\",\"hrefLang\":\"en-US\",\"href\":\"https://corinthionia.github.io/en-US\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"hrefLang\":\"ko-KR\",\"href\":\"https://corinthionia.github.io/ko-KR\"}],[\"$\",\"meta\",\"8\",{\"name\":\"google-site-verification\",\"content\":\"yUSWYuB2Vp_rkwga3zPaQBERVNUHmls939PmQ7PY0VE\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:title\",\"content\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:description\",\"content\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:url\",\"content\":\"https://corinthionia.github.io/post/react/axios-interceptors-token\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:site_name\",\"content\":\"Corinthionia\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:locale\",\"content\":\"ko_KR\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image\",\"content\":\"https://corinthionia.github.io/thumbnail/post/axios-interceptor-token.png\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:published_time\",\"content\":\"2022-01-23T00:00:00.000Z\"}],[\"$\",\"meta\",\"17\",{\"property\":\"article:modified_time\",\"content\":\"2022-01-23T00:00:00.000Z\"}],[\"$\",\"meta\",\"18\",{\"property\":\"article:author\",\"content\":\"Corinthionia\"}],[\"$\",\"meta\",\"19\",{\"property\":\"article:author\",\"content\":\"Joohyun Kim\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:title\",\"content\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:description\",\"content\":\"axios request interceptors 로 access token 재발급하기\"}],[\"$\",\"meta\",\"23\",{\"name\":\"twitter:image\",\"content\":\"https://corinthionia.github.io/thumbnail/post/axios-interceptor-token.png\"}],[\"$\",\"link\",\"24\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"meta\",\"25\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"8:null\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"p\",null,{\"children\":[\"사실 이 부분은 금방 끝날 줄 알았는데 아니었다... ㅠ\",[\"$\",\"br\",null,{}],\"\\n\",\"삽질도 많이 하고 에러도 많이 마주쳤던 부분이라 기록하고자 글을 남긴다.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"1-refresh-token과-access-token\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#1-refresh-token과-access-token\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"1. refresh token과 access token\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"간단하게 말하자면 access token은 사용자가 요청을 보낼 때 사용하는 토큰인데, 보안 문제로 유효 기간이 짧다.\",[\"$\",\"br\",null,{}],\"\\n\",\"refresh token은 access token보다 유효 기간이 길어서, 만약 access token이 만료되었다면 refresh token을 이용해 access token을 재발급받을 수 있다.\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"2-구현-방식에-대한-고민들\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#2-구현-방식에-대한-고민들\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"2. 구현 방식에 대한 고민들\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"access-token이-만료되면-재발급-요청을-어떻게-해야-하는가\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#access-token이-만료되면-재발급-요청을-어떻게-해야-하는가\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"access token이 만료되면 재발급 요청을 어떻게 해야 하는가?\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"사용자가 만료된 access token을 가지고 요청을 보내면 그때 토큰을 재발급하는 방식\",[\"$\",\"br\",null,{}],\"\\n\",\"→ 해당 요청이 수행되지 않아 다시 요청을 보내야 하는 UX적인 단점 존재\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"토큰 만료 시점을 미리 계산하고, 만료 시점에 근접했을 때 토큰을 재발급받는 방식\",[\"$\",\"br\",null,{}],\"\\n\",\"→ 만료 시점에 근접했을 때 재발급 요청을 어떻게 해야 할지 감이 안 잡힘...\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"요청을 보낸 후 만료 응답을 받으면 그때 재발급 요청\",[\"$\",\"br\",null,{}],\"\\n\",\"→ 이래도 401 에러는 뜨더라\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"결과적으로-채택한-방식\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#결과적으로-채택한-방식\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"결과적으로 채택한 방식\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"request를 가로채서 토큰의 유효 시간을 살핀 다음, 만료까지 1분 미만으로 남았다면 토큰을 재발급받은 후 해당 요청을 보내는 방식을 생각했다.\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"그런데 아무리 시도해 봐도 에러 해결이 안 되고, 아무리 찾아봐도 response를 가로채는 예시들만 나와서 일단은 \",[\"$\",\"code\",null,{\"children\":\"response interceptor (응답 인터셉터)\"}],\"로 구현했다. (이 예시는 구글링하면 많이 나와서 생략하겠다.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"하지만 응답 인터셉터를 사용해도 콘솔 창에 401 에러가 뜨는 게 보기 싫었고, (실행은 잘됨) \",[\"$\",\"code\",null,{\"children\":\"request interceptor (요청 인터셉터)\"}],\"로 구현하는 게 더 효율적이라고 판단하여 처음부터 끝까지 내가 구현해 보자고 마음 먹었다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"따라서 구현한 코드는 다음과 같다.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"구현-과정\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#구현-과정\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"구현 과정\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"로직-설명\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#로직-설명\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"로직 설명\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"로그인 시 refresh token과 access token을 \",[\"$\",\"code\",null,{\"children\":\"local storage\"}],\"에 저장을 해 두었고, \",[\"$\",\"code\",null,{\"children\":\"local storage\"}],\"에 access token이 존재한다면, 이를 헤더에 담아 요청을 보낸다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"jwt-decode\"}],\" 라이브러리를 활용하여 access token과 refresh token의 만료 시간을 알아내고, 이를 로컬 스토리지에 저장해 두었다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"refresh token이 로컬 스토리지에 저장이 되어 있고 (즉, 로그인한 사용자고) access token의 만료 시점과 현재 시간의 차가 1분 미만이라면, access token 재발급을 요청한다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"우리는 refresh token을 \",[\"$\",\"code\",null,{\"children\":\"application/x-www-form-urlencoded\"}],\" 타입으로 담아서 보내기 때문에 \",[\"$\",\"code\",null,{\"children\":\"URLSearchParams()\"}],\"를 사용했다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"그리고 재발급받은 access token과 만료 시점(expiredAt)을 로컬 스토리지에 저장해 두었다. (expiredAt을 갱신하지 않으면 또 에러가 생긴다!) 그리고 마지막 부분에는 재발급 받은 access token을 헤더에 기본으로 붙여 두었다.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"이때 주의할 점!\"}],\" interceptor 안에 refresh token을 요청하는 코드를 작성할 때, instance를 호출하면 안 된다. 그러면 요청 → interceptor 실행 → interceptor 속 instance의 interceptor 실행 → ... 으로 무한 루프가 생겨 버린다. 그래서 나도 instance를 사용하지 않고 그냥 axios를 사용했다.\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"구현한-코드\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#구현한-코드\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"구현한 코드\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"axios.create()\"}],\"으로 작성한 \",[\"$\",\"code\",null,{\"children\":\"instance\"}],\"의 \",[\"$\",\"code\",null,{\"children\":\"request interceptor\"}],\" 코드다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-jsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"instance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"interceptors\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"config\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" accessToken \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'accessToken'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  accessToken \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Authorization\"}]}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"Bearer \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"accessToken\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" refreshToken \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'refreshToken'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'expiredAt'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// if the token expires within a minute\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"refreshToken\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" params \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"URLSearchParams\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'refresh'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" refreshToken\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" data \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" axios\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"post\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'요청 주소'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'application/x-www-form-urlencoded'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"setItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'accessToken'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"access\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"setItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'expiredAt'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"jwtDecode\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"access\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"exp\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Authorization'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"Bearer \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"access\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"마주쳤던-에러들\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#마주쳤던-에러들\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"마주쳤던 에러들\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"삽질-1-date-객체-관련\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#삽질-1-date-객체-관련\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"삽질 1. Date 객체 관련\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"access token을 디코딩해서 만료 시간(exp)을 알아내려고 했다. 그런데 이 값은 초 단위이고, JavaScript Date 객체를 사용해서 얻은 값은 밀리 초 단위이다. 따라서 exp 값에 1000을 곱한 후 Date 객체에 넣으면 대충 \",[\"$\",\"code\",null,{\"children\":\"Sat Jan 08 2022 03:10:30 GMT+0900 (한국 표준시)\"}],\" 형태로 출력될 것이라고 생각했다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"그래서 시험 삼아 발급 시간(iat)과 만료 시간(exp) 각각에 1000을 곱한 후 Date 객체에 넣어 봤더니, 분명 다른 숫자임에도 불구하고 같은 시간대가 출력되었다. (원래는 30분의 시차가 있어야 함)\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-jsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 에러 코드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" decoded \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"jwtDecode\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"data\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"token\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"access\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" exp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" decoded\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"exp\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" iat \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" decoded\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"iat\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"발급 시간: \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"iat \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"만료 시간: \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"exp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 출력 예시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"발급 시간\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Sat\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Jan\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"08\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2022\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"03\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"00\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"13\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GMT\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0900\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"한국 표준시\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"만료 시간\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Sat\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Jan\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"08\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2022\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"03\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"00\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"13\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GMT\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0900\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"한국 표준시\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"거의 세 시간 동안 붙잡고 있었는데 @김현재 님이 도와주셔서 해결할 수 있었다...\",[\"$\",\"br\",null,{}],\"\\n\",\"Date ‘객체’라서 객체 참조에 관한 문제였다고 한다 🫠\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-jsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" decoded \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"jwtDecode\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"data\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"token\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"access\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" iat \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" decoded\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"iat\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" exp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" decoded\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"exp\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"발급 시간: \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"iat \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"만료 시간: \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"exp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"현재 시간: \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"now\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 출력 예시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"발급 시간\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Sat\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Jan\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"08\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2022\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"03\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"00\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"13\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GMT\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0900\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"한국 표준시\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"만료 시간\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Sat\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Jan\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"08\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2022\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"03\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"30\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"13\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GMT\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0900\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"한국 표준시\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"현재 시간\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Sat\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Jan\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"08\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2022\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"03\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"00\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"13\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GMT\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0900\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"한국 표준시\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"따라서 앞에 new 연산자를 꼭 붙여 줘야 제대로 나온다!\"}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"삽질-2-무한-루프\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#삽질-2-무한-루프\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"삽질 2: 무한 루프\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"axios interceptor를 잘못 작성해서 무한 루프에 빠져 버림...\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-jsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 에러 코드 \u0026\u0026 로직 수정 전 코드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"instance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"interceptors\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"config\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" refreshToken \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"refreshToken\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"parseInt\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"expiredAt\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" params \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"URLSearchParams\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'refresh'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" refreshToken\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" data \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" instance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"post\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'요청 주소'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'application/x-www-form-urlencoded'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 생략\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"정확하진 않지만 \",[\"$\",\"code\",null,{\"children\":\"interceptor\"}],\" 안에서 또 \",[\"$\",\"code\",null,{\"children\":\"instance\"}],\"를 호출해 요청을 보내다 보니 무한 루프가 생긴 것 같다 ㅠㅠ 그래서 아래처럼 수정했더니 잘됐던 걸로 기억함 (아마도)\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-jsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 에러 코드 \u0026\u0026 로직 수정 전 코드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"instance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"interceptors\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"use\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"config\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" refreshToken \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"refreshToken\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"parseInt\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token dom variable\",\"children\":\"localStorage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getItem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"expiredAt\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Date\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"expiredAt \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" now \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" params \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"URLSearchParams\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'refresh'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" refreshToken\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" data \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" axios\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"post\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'요청 주소'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" params\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'application/x-www-form-urlencoded'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 생략\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"후기\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#후기\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"후기\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"하나 고치면 다른 데서 에러 생기고 🫠 계속해서 오류를 뱉어서 화가 나긴 했지만 그래도 수정하는 재미가 있었다! 이 과정과는 별개로 token과 관련된 모든 정보들을 로컬 스토리지에 저장하는 게 맞나 하는 생각이 든다 🤔 보안상의 이슈가 있을 것 같은데 더 좋은 방법을 찾아보고 리팩토링해 봐야겠다!\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"참고-자료\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#참고-자료\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"참고 자료\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://yamoo9.github.io/axios/guide/interceptors.html\",\"children\":\"Axios 러닝 가이드 - interceptor\"}]}]]\n"])</script></body></html>